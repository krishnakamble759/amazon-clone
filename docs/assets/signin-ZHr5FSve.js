document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("email-step"),r=document.getElementById("password-step"),i=document.getElementById("email"),m=document.getElementById("password"),c=document.getElementById("email-continue-btn"),d=document.getElementById("signin-btn"),u=document.getElementById("user-display-email"),g=document.getElementById("change-email-link"),l=document.getElementById("registerForm");if(a){const s=localStorage.getItem("temp_signin_email");s&&(i.value=s),c.addEventListener("click",()=>{const e=i.value.trim();if(!e){alert("Enter your email or mobile phone number");return}if(!JSON.parse(localStorage.getItem("amazon_users")||"{}")[e]){confirm("We cannot find an account with this email address. Would you like to create a new account?")&&(window.location.href="/register.html");return}localStorage.setItem("temp_signin_email",e),u.textContent=e,a.classList.add("d-none"),r.classList.remove("d-none")}),d.addEventListener("click",()=>{const e=m.value;if(!e){alert("Enter your password");return}const t=localStorage.getItem("temp_signin_email"),n=JSON.parse(localStorage.getItem("amazon_users")||"{}");n[t]&&n[t].password===e?(localStorage.setItem("current_user",JSON.stringify(n[t])),window.location.href="index.html"):alert("To better protect your account, please re-enter your password then the characters as shown in the image below. (Mock: Wrong password)")}),g.addEventListener("click",e=>{e.preventDefault(),r.classList.add("d-none"),a.classList.remove("d-none")})}l&&l.addEventListener("submit",s=>{s.preventDefault();const e=document.getElementById("name").value,t=document.getElementById("reg-email").value.trim(),n=document.getElementById("reg-password").value,p=document.getElementById("reg-password-confirm").value;if(n!==p){alert("Passwords do not match");return}const o=JSON.parse(localStorage.getItem("amazon_users")||"{}");if(o[t]){alert("Email already registered. Please sign in."),window.location.href="/signin.html";return}o[t]={name:e,email:t,password:n},localStorage.setItem("amazon_users",JSON.stringify(o)),localStorage.setItem("temp_signin_email",t),alert("Account created successfully!"),window.location.href="/signin.html"})});
